<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Mobile Download</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 15px;
            background: #111;
            color: white;
            font-size: 16px;
        }
        .test-container {
            max-width: 100%;
        }
        .device-info {
            background: #222;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #333;
        }
        .test-session {
            background: #333;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }
        .test-link {
            display: block;
            background: linear-gradient(135deg, #00ff88, #00cc66);
            color: black;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        .test-link:active {
            background: linear-gradient(135deg, #00cc66, #00aa55);
            transform: scale(0.95);
        }
        .logs {
            background: #000;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            border: 1px solid #333;
        }
        .error { color: #ff6b6b; }
        .warn { color: #ffd93d; }
        .success { color: #6bcf7f; }
        .info { color: #74c0fc; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üì± Test Mobile Download</h1>
        
        <div class="device-info" id="deviceInfo">
            <h3>üì± Informaci√≥n del Dispositivo</h3>
            <p>Cargando...</p>
        </div>
        
        <div class="test-session">
            <h3>üß™ Instrucciones de Prueba</h3>
            <p>1. Toca cualquier enlace de sesi√≥n</p>
            <p>2. Busca el bot√≥n "Descargar" debajo de duraci√≥n/calidad</p>
            <p>3. Toca el bot√≥n "Descargar"</p>
            <p>4. Verifica que se abre el modal</p>
            <p>5. Toca "Ir a la descarga"</p>
            <p>6. Verifica que se abre la URL</p>
        </div>
        
        <h2>üéµ Sesiones de Prueba</h2>
        
        <a href="player.html?session=first-date-vol-ii" class="test-link">
            üè† First Date Vol.II (House MP3)
        </a>
        
        <a href="player.html?session=nati-nati" class="test-link">
            üé∂ Nati Nati (House MP3)
        </a>
        
        <a href="player.html?session=primavera-sound" class="test-link">
            üå∏ Primavera Sound (House FLAC)
        </a>
        
        <a href="player.html?session=nature-tech-house" class="test-link">
            üî• Nature (Techno MP3)
        </a>
        
        <a href="player.html?session=elrow" class="test-link">
            üé™ ElROW (Techno FLAC)
        </a>
        
        <a href="player.html?session=plastic" class="test-link">
            üìÄ Plastic (Remember FLAC)
        </a>
        
        <a href="player.html?session=insane" class="test-link">
            üéß Insane (Progressive FLAC)
        </a>
        
        <div class="logs" id="testLogs">
            <strong>üìã Logs de Prueba:</strong><br>
        </div>
    </div>

    <script>
        let logs = [];
        
        function addLog(type, message, data = null) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = { timestamp, type, message, data };
            logs.push(logEntry);
            
            if (logs.length > 30) {
                logs.shift();
            }
            
            updateLogDisplay();
            console.log(`[${type}] ${message}`, data || '');
        }
        
        function updateLogDisplay() {
            const container = document.getElementById('testLogs');
            const lastLogs = logs.slice(-15);
            
            container.innerHTML = '<strong>üìã Logs de Prueba:</strong><br>' + 
                lastLogs.map(log => 
                    `<div class="${log.type.toLowerCase()}">
                        [${log.timestamp}] ${log.type}: ${log.message}
                        ${log.data ? '<br><small>' + JSON.stringify(log.data, null, 2) + '</small>' : ''}
                    </div>`
                ).join('');
            
            container.scrollTop = container.scrollHeight;
        }
        
        // Interceptar logs de consola
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.log = (...args) => {
            originalLog.apply(console, args);
            if (args[0] && typeof args[0] === 'string') {
                if (args[0].includes('descarga') || args[0].includes('modal') || args[0].includes('Touch')) {
                    addLog('INFO', args.join(' '));
                }
            }
        };
        
        console.error = (...args) => {
            originalError.apply(console, args);
            addLog('ERROR', args.join(' '));
        };
        
        console.warn = (...args) => {
            originalWarn.apply(console, args);
            addLog('WARN', args.join(' '));
        };
        
        // Detectar informaci√≥n del dispositivo
        document.addEventListener('DOMContentLoaded', () => {
            const deviceInfo = {
                userAgent: navigator.userAgent,
                isAndroid: /Android/i.test(navigator.userAgent),
                isIOS: /iPad|iPhone|iPod/.test(navigator.userAgent),
                isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                         (navigator.maxTouchPoints && navigator.maxTouchPoints > 0) ||
                         'ontouchstart' in window,
                touchSupport: 'ontouchstart' in window,
                maxTouchPoints: navigator.maxTouchPoints,
                audioSupport: !!window.Audio,
                screen: {
                    width: screen.width,
                    height: screen.height,
                    orientation: screen.orientation ? screen.orientation.type : 'unknown'
                }
            };
            
            document.getElementById('deviceInfo').innerHTML = `
                <h3>üì± Informaci√≥n del Dispositivo</h3>
                <p><strong>Android:</strong> ${deviceInfo.isAndroid ? '‚úÖ S√≠' : '‚ùå No'}</p>
                <p><strong>iOS:</strong> ${deviceInfo.isIOS ? '‚úÖ S√≠' : '‚ùå No'}</p>
                <p><strong>M√≥vil:</strong> ${deviceInfo.isMobile ? '‚úÖ S√≠' : '‚ùå No'}</p>
                <p><strong>Touch:</strong> ${deviceInfo.touchSupport ? '‚úÖ S√≠' : '‚ùå No'}</p>
                <p><strong>Touch Points:</strong> ${deviceInfo.maxTouchPoints}</p>
                <p><strong>Audio:</strong> ${deviceInfo.audioSupport ? '‚úÖ S√≠' : '‚ùå No'}</p>
                <p><strong>Pantalla:</strong> ${deviceInfo.screen.width}x${deviceInfo.screen.height}</p>
                <p><strong>Orientaci√≥n:</strong> ${deviceInfo.screen.orientation}</p>
                <p><strong>User Agent:</strong><br><small>${deviceInfo.userAgent}</small></p>
            `;
            
            addLog('INIT', 'Dispositivo detectado', deviceInfo);
            
            // Test de eventos t√°ctiles
            if (deviceInfo.isMobile) {
                addLog('INFO', 'Dispositivo m√≥vil detectado - eventos t√°ctiles disponibles');
                
                // Test b√°sico de touch
                document.body.addEventListener('touchstart', () => {
                    addLog('SUCCESS', 'Touch start detectado en body');
                }, { once: true, passive: true });
            } else {
                addLog('INFO', 'Dispositivo desktop detectado - usando eventos click');
            }
        });
        
        // Interceptar clicks en enlaces para logging
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('test-link') || e.target.closest('.test-link')) {
                const link = e.target.closest('.test-link') || e.target;
                addLog('CLICK', 'Click en enlace de prueba', {
                    href: link.href,
                    text: link.textContent.trim()
                });
            }
        });
        
        // Interceptar eventos t√°ctiles en enlaces
        document.addEventListener('touchend', (e) => {
            if (e.target.classList.contains('test-link') || e.target.closest('.test-link')) {
                const link = e.target.closest('.test-link') || e.target;
                addLog('CLICK', 'Touch end en enlace de prueba', {
                    href: link.href,
                    text: link.textContent.trim()
                });
            }
        }, { passive: true });
    </script>
</body>
</html>
